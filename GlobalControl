VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "GlobalControl"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Explicit

Public WithEvents GlUserForm As MSForms.UserForm
Attribute GlUserForm.VB_VarHelpID = -1
Public WithEvents GlLabel As MSForms.Label
Attribute GlLabel.VB_VarHelpID = -1
Public WithEvents GlTextBox As MSForms.TextBox
Attribute GlTextBox.VB_VarHelpID = -1
Public WithEvents GlButton As MSForms.CommandButton
Attribute GlButton.VB_VarHelpID = -1
Public WithEvents GlComboBox As MSForms.ComboBox
Attribute GlComboBox.VB_VarHelpID = -1
Public WithEvents GlListBox As MSForms.ListBox
Attribute GlListBox.VB_VarHelpID = -1

Public Event GlMouseMove()

Dim pGlX As Single

Property Get GlX() As Single
  GlX = pGlX
End Property

Private Sub GlLabel_Click()
  Dim ParentForm As UserForm
  Set ParentForm = GetParentForm(GlLabel)
  
End Sub

Private Sub GlLabel_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  'Dim ParentForm As UserForm
  'Set ParentForm = GetParentForm(GlLabel)
  pGlX = GlLabel.Left + X
  'Debug.Print "[GlLabel_MouseMove]", pGlX
  RaiseEvent GlMouseMove
End Sub


''' Apparently this might not be necessary
Private Function GetParentForm(Control As MSForms.Control) As MSForms.UserForm
  Dim Parent
  Set Parent = Control.Parent
  
  Do While Not TypeOf Parent Is MSForms.UserForm
    Debug.Assert False
    Set Parent = Parent.Parent
  Loop
  
  Set GetParentForm = Parent
  
End Function

