VERSION 5.00
Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} FrmPaletteViewer 
   Caption         =   "Palette Viewer"
   ClientHeight    =   6075
   ClientLeft      =   45
   ClientTop       =   390
   ClientWidth     =   8580
   OleObjectBlob   =   "FrmPaletteViewer.frx":0000
   StartUpPosition =   1  'CenterOwner
End
Attribute VB_Name = "FrmPaletteViewer"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

''' TODO: Fix Z-Ordering
Dim MouseDown As Boolean

Dim Movables(2) As MSForms.Label
Dim SelectedLbl As MSForms.Label
Dim DX As Single
Dim DY As Single
Dim PX As Single
Dim PY As Single

Private Sub Label2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  MouseDown = True
  Dim I As Integer
  For I = LBound(Movables) To UBound(Movables)
    If Label2.Left + X >= Movables(I).Left And Label2.Left + X <= Movables(I).Left + Movables(I).Width And _
       Label2.Top + Y >= Movables(I).Top And Label2.Top + Y <= Movables(I).Top + Movables(I).Height Then
      Set SelectedLbl = Movables(I)
      DX = (Label2.Left + X) - SelectedLbl.Left
      DY = (Label2.Top + Y) - SelectedLbl.Top
      PX = X
      PY = Y
      Exit For
    End If
  Next
  
End Sub

Private Sub Label2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  Label3.Caption = Label3.Left
  Label4.Caption = Label4.Left
  Label5.Caption = Label5.Left
  
  
  Label6.Caption = "LX " & X & vbNewLine & "FX " & Label2.Left + X
  
  If SelectedLbl Is Nothing Then Exit Sub
  
  Label6.Caption = Label6.Caption & vbNewLine & "SL.Left " & SelectedLbl.Left
  
  Dim NX As Single
  NX = Label2.Left + X - DX
  
  If SelectedLbl.Left - (PX - X) < Label2.Left Then
    NX = Label2.Left
  ElseIf SelectedLbl.Left + SelectedLbl.Width - (PX - X) > Label2.Left + Label2.Width Then
    NX = Label2.Left + Label2.Width - SelectedLbl.Width
  Else
    PX = X
  End If
  
  
  Dim NY As Single
  NY = Label2.Top + Y - DY
  
  If SelectedLbl.Top - (PY - Y) < Label2.Top Then
    NY = Label2.Top
  ElseIf SelectedLbl.Top + SelectedLbl.Height - (PY - Y) > Label2.Top + Label2.Height Then
    NY = Label2.Top + Label2.Height - SelectedLbl.Height
  Else
    PY = Y
  End If
  
  SelectedLbl.Left = NX
  SelectedLbl.Top = NY
  
End Sub

Private Sub Label2_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  MouseDown = False
  Set SelectedLbl = Nothing
End Sub



Private Sub UserForm_Initialize()
  
  Label2.Caption = Label2.Left
  Label3.Caption = Label3.Left
  Label4.Caption = Label4.Left
  Label5.Caption = Label5.Left
  
  MouseDown = False
  Set Movables(0) = Me.Label3
  Set Movables(1) = Me.Label4
  Set Movables(2) = Me.Label5
    
  ''''''''''''''''''''''''''''''''
  Dim Palettes(5 - 1, 1)
  Palettes(0, 0) = PaletteColorAsparagus
  Palettes(0, 1) = "Asparagus"
  Palettes(1, 0) = PaletteColorAlmond
  Palettes(1, 1) = "Almond"
  Palettes(2, 0) = PaletteColorSpaceCadet
  Palettes(2, 1) = "Space Cadet"
  Palettes(3, 0) = PaletteColorTaupeGray
  Palettes(3, 1) = "Taupe Gray"
  Palettes(4, 0) = PaletteColorRoseQuartz
  Palettes(4, 1) = "Rose Quartz"
  
  Dim I As Integer
  Dim Padding As Single: Padding = 20
  Dim LblWidth As Single: LblWidth = 50
  Dim LblHeight As Single: LblHeight = 50
  
  For I = LBound(Palettes) To UBound(Palettes)
    Dim Lbl As MSForms.Label
    Set Lbl = Me.Controls.Add("Forms.Label.1", , True)
    Lbl.Left = Padding + (I * (LblWidth + Padding))
    Lbl.Top = Padding
    Lbl.Width = LblWidth
    Lbl.Height = LblHeight
    Lbl.BorderColor = vbBlack
    Lbl.BorderStyle = fmBorderStyleSingle
    Lbl.BackColor = Palettes(I, 0)
    Lbl.Caption = Palettes(I, 1)
    Lbl.TextAlign = fmTextAlignCenter
    
    ' Possibly add a 'slider' to form to adjust threshold
    If Palettes(I, 0) < 6000000 Then Lbl.ForeColor = vbWhite
    'Debug.Print Palettes(I, 0)
  Next
  
  Call ApplyPalette(Me)
  
End Sub

Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  'Label1.Picture = LoadPicture("C:\users\ernie\onedrive\documents\programming\vba\button_assets\button_default.jpg")
  Label1.BackColor = SystemColorConstants.vbButtonFace
  MouseDown = False
End Sub

Private Sub Label1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  'Label1.Picture = LoadPicture("C:\users\ernie\onedrive\documents\programming\vba\button_assets\button_hover.jpg")
  If Not MouseDown Then Label1.BackColor = PaletteColorAlmond
End Sub

Private Sub Label1_Click()
  'Label1.Picture = LoadPicture("C:\users\ernie\onedrive\documents\programming\vba\button_assets\button_down.jpg")
  'Label1.BackColor = PaletteColorAsparagus
End Sub

Private Sub Label1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  'Label1.Picture = LoadPicture("C:\users\ernie\onedrive\documents\programming\vba\button_assets\button_down.jpg")
  Label1.BackColor = PaletteColorRoseQuartz
  MouseDown = True
End Sub

Private Sub Label1_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  MouseDown = False
End Sub
